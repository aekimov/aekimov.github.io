<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd"> <html><body> <h4>Learn how to add a snapping effect and implement horizontal paging in UICollectionView with this step-by-step tutorial.</h4> <figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*yNjlFr0cd-oFO90sb8TJXA.jpeg"></figure> <p>You can find the project on <a href="https://github.com/aekimov/HorizontalPagingCollectionView" rel="external nofollow noopener" target="_blank">GitHub</a> with a detailed history of changes made to the code.</p> <p>Let’s say we have a horizontal collection view, the cells have a fixed height and stretch to the width of the collection view (in this example, the collection view width matches the screen width). I applied different colors to visually distinct them.</p> <figure><img alt="" src="https://cdn-images-1.medium.com/max/421/1*QCM6899oDs0g7h3HkkXh3w.gif"><figcaption>Cell Width = Scroll View Bounds Width</figcaption></figure> <p>It works just fine, but we desire a snapping paging effect when scrolling left or right. This effect is achieved by using the isPagingEnabled property of UICollectionView, which is a Boolean value that determines whether paging is enabled for the scroll view.</p> <blockquote>If the value of this property is true, the scroll view stops on multiples of the scroll view’s bounds when the user scrolls. The default value is false.</blockquote> <figure><img alt="" src="https://cdn-images-1.medium.com/max/421/1*NBgv22MGjLpgcv1SqEMXVw.gif"><figcaption>isPagingEnabled = true</figcaption></figure> <p>If the collection view and cell widths are the same, you only need to change this property.</p> <p>However, this approach becomes ineffective as soon as we adjust the section insets or spacing between cells. Since the scroll view stops at multiples of its bounds, this can cause the cell to no longer align with it.</p> <p>Let’s modify the cell size and add spacing between them by adjusting sectionInset and minimumLineSpacing properties of the layout.</p> <figure><img alt="" src="https://cdn-images-1.medium.com/max/444/1*CM0dhws-H3SlSYLuyw4d5w.gif"><figcaption>sectionInset = UIEdgeInsets(top: 0, left: 20, bottom: 0, right: 20), minimumLineSpacing = 16</figcaption></figure> <p>My desired result is that the cells are centered and that the same number of neighboring cells are visible on both sides. There are various solutions available to achieve this, such as manually calculating the required scroll view offset based on the item size, insets, and spacing, and using the setContentOffset method of the scroll view. However, I find this approach to be somewhat cumbersome.</p> <p>Instead, we can check the start and end positions and compare the difference to a threshold. We need to add some variables for the current page, before and after the offsets, and a constant variable for the threshold. Don’t forget to switch isPagingEnabled to false or just remove it because it defaults to false.</p> <iframe src="" width="0" height="0" frameborder="0" scrolling="no"><a href="https://medium.com/media/0df3af35b99551e4481f84b4ec8028cc/href" rel="external nofollow noopener" target="_blank">https://medium.com/media/0df3af35b99551e4481f84b4ec8028cc/href</a></iframe> <p>We are going to use two scroll view’s delegate methods scrollViewWillBeginDragging and scrollViewWillEndDragging.</p> <p>The approach is relatively straightforward — we set a beforeOffset in scrollViewWillBeginDragging when we start dragging and an afterOffset in scrollViewWillEndDragging when we’re about to finish. After that we calculate the difference between the two and compare it to the threshold value, while also taking into account edge cases to ensure that the index we need to scroll to exists and is within the range.</p> <iframe src="" width="0" height="0" frameborder="0" scrolling="no"><a href="https://medium.com/media/b3d583fc3eb0ed33aaa3d74e0d09d3c9/href" rel="external nofollow noopener" target="_blank">https://medium.com/media/b3d583fc3eb0ed33aaa3d74e0d09d3c9/href</a></iframe> <figure><img alt="" src="https://cdn-images-1.medium.com/max/444/1*TbftUG5Us0eE60GF9BIIiA.gif"><figcaption>Final Result</figcaption></figure> <p>This is the desired outcome. This approach can be applied to vertical collection views as well.</p> <p>I think it needs a couple of words why we needed the first line of code in scrollViewWillEndDragging</p> <pre>targetContentOffset.pointee = scrollView.contentOffset</pre> <blockquote> <strong><em>targetContentOffset </em></strong>— the expected offset when the scrolling action decelerates to a stop. Your application can change the value of the targetContentOffset parameter to adjust where the scrollview finishes its scrolling animation.</blockquote> <p>If the user leaves some velocity going after lifting their finger, it can interfere with our snapping effect. To prevent this, we will implement a solution to halt any sliding effect as soon as the user lifts their finger.</p> <p>Additionally, if we want to observe any changes of the page index from the outside we could add a closure and trigger it through a didSet property observer. We can provide the previous (oldValue) page index as well.</p> <iframe src="" width="0" height="0" frameborder="0" scrolling="no"><a href="https://medium.com/media/2b8e5cefb1b5ba55a7518743260c4c0d/href" rel="external nofollow noopener" target="_blank">https://medium.com/media/2b8e5cefb1b5ba55a7518743260c4c0d/href</a></iframe> <p>You can find the final project on <a href="https://github.com/aekimov/HorizontalPagingCollectionView" rel="external nofollow noopener" target="_blank">GitHub</a>.</p> <p>Thank you for reading this article, I hope you found it helpful! Please feel free to leave a comment or ask any questions you may have — I would love to hear your thoughts.</p> <p><img src="https://medium.com/_/stat?event=post.clientViewed&amp;referrerSource=full_rss&amp;postId=6295a38e49bf" width="1" height="1" alt="">&lt;hr&gt;&lt;p&gt;<a href="https://itnext.io/how-to-add-horizontal-paging-with-snapping-effect-in-uicollectionview-6295a38e49bf" rel="external nofollow noopener" target="_blank">How to Add Horizontal Paging with Snapping Effect in UICollectionView</a> was originally published in <a href="https://itnext.io" rel="external nofollow noopener" target="_blank">ITNEXT</a> on Medium, where people are continuing the conversation by highlighting and responding to this story.&lt;/p&gt;</p> </body></html>